<Page navigatingTo="onNavigatingTo" xmlns="http://schemas.nativescript.org/tns.xsd">
  <ActionBar class="app-bar" flat="true">
    <ActionBar.titleView>
      <GridLayout columns="*,auto">
        <FlexboxLayout class="brand">
          <Image class="brand-icon" src="~/assets/logo.png" />
          <Label class="brand-title">
            <FormattedString>
              <Span text="Tic-Tac-Toe" />
              <Span text="Twist" class="twist" />
            </FormattedString>
          </Label>
        </FlexboxLayout>
      </GridLayout>
    </ActionBar.titleView>
  </ActionBar>

  <ScrollView>
    <StackLayout class="sheet">
      <StackLayout class="section">
        <Label class="section-heading" text="Game Setup" />
        <Label class="section-subtitle" text="Board size 🔲" />
        <FlexboxLayout class="segmented" justifyContent="center">
          <Repeater items="{{ boardOptions }}">
            <Repeater.itemsLayout>
              <FlexboxLayout style="width: 100%"/>
            </Repeater.itemsLayout>
            <Repeater.itemTemplate>
              <StackLayout class="{{ `segmented-option${selected ? ' active' : ''}` }}" tap="onSelectBoard">
                <Label horizontalAlignment="center" text="{{ label }}" />
              </StackLayout>
            </Repeater.itemTemplate>
          </Repeater>
        </FlexboxLayout>
      </StackLayout>

      <StackLayout class="section">
        <StackLayout>
          <Label class="slider-label" text="{{ `Win length ${winLengthLabel}` }} " />
          <Label class="meta" text="Choose how many in a row wins the game." textWrap="true" />
          <Label class="meta" text="Options limited by board size." textWrap="true" />
          <Label class="meta" text="Slide up or down to select." textWrap="true" />
        </StackLayout>
        <ListPicker class="slider" items="{{ winLengthArray }}" selectedIndex="{{ winLengthIndex }}" selectedIndexChange="onWinLengthChanged" />
      </StackLayout>

      <StackLayout class="section">
        <Label class="section-heading" text="Variants ℹ️" />
        <Repeater items="{{ variantOptions }}">
          <Repeater.itemTemplate>
            <GridLayout columns="*,auto" class="variant-row" tap="onToggleVariant">
              <StackLayout col="0">
                <Label class="variant-title" text="{{ title + ' ' + icon }}" />
                <Label class="variant-description" text="{{ description }}" textWrap="true" />
              </StackLayout>
              <Switch col="1" checked="{{ active }}" checkedChange="onVariantToggleChange" />
            </GridLayout>
          </Repeater.itemTemplate>
        </Repeater>
      </StackLayout>

      <StackLayout class="section">
        <Label class="section-heading" text="Difficulty" />
        <FlexboxLayout class="difficulty-group" justifyContent="center">
          <Repeater items="{{ difficultyOptions }}">
            <Repeater.itemsLayout>
              <FlexboxLayout style="width: 100%"/>
            </Repeater.itemsLayout>
            <Repeater.itemTemplate>
              <StackLayout class="{{ `difficulty-chip${active ? ' active' : ''}` }}" tap="onSelectDifficulty">
                <Label horizontalAlignment="center" class="difficulty-title" text="{{ title }}" />
                <Label horizontalAlignment="center" class="difficulty-caption" text="{{ caption }}" />
              </StackLayout>
            </Repeater.itemTemplate>
          </Repeater>
        </FlexboxLayout>
      </StackLayout>

      <Button text="Start Game" class="primary-cta" tap="onStartGame" />
      <Label text="How to play" class="secondary-link" tap="onHowToPlay" />
    </StackLayout>
  </ScrollView>
</Page>
